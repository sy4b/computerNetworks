# 6.1 应用网络模型
## 6.1.1 客户/服务器模型（C/S
**C/S（Client/Server）模型中，总是打开的主机称为服务器，服务其他称为客户机的主机请求**

常见的使用C/S模型的应用包括：**Web、文件传输协议（FTP）、远程登录和电子邮件**等

特点

1. 网络中计算机的地位不平等，服务器可以管理客户机
2. 客户机相互之间不直接通信
3. 可扩展性不佳，受服务器硬件和网络带宽限制，服务器支持的客户机有限

> 1. 客户端必须提前知道服务器的地址，服务器则不需要提前知道客户端的地址
> 2. 客户端主要实现如何显示信息与收集用户输入，服务器主要实现数据处理
> 3. 客户机面向用户，服务器面向任务

## 6.1.2 P2P模型
整个网络中的传输内容不再被保存在中心服务器上，**每个节点都同时具有下载、上传功能，节点权利和义务大体对等**

P2P模型中，各计算机没有固定的客户和服务器划分，任意一对计算机——对等方（peer）直接相互通信。常用的P2P应用有PPlive、Bittorrent和电驴

P2P相比C/S优点：

1. 减轻服务器计算压力，消除了对某个服务器完全依赖，可以将任务分配到各个节点上，提高系统效率和资源利用率
2. 多个客户机之间可以直接共享文档
3. 可扩展性好
4. 网络健壮性强，单个节点失效不会影响其他部分的节点

缺点：节点在获取服务的同时也要提供服务，会占用较多内存，影响整机速度

> 1. P2P网络是与互联网并行建设的、由对等节点组成的逻辑网络（不是物理网络

# 6.2 域名系统（DNS
DNS（domain name system）是因特网使用的命名系统，**用于把便于人们记忆的含有特定含义的主机名（例如baidu.com）转换为IP地址**

1. DNS使用**C/S模型**
2. DNS协议运行在**UDP**之上
3. DNS使用**53号端口**

从概念上可以将DNS分为：**层次域名空间、域名服务器、解析器**

> 1. **域名和IP地址、MAC地址、主机 没有一一对应的关系**
> 2. Internet上提供客户访问的主机不一定要有域名

## 6.2.1 层次域名空间
因特网采用层次树状结构的命名方法

例如www.cskaoyan.com，com为顶级域名、cskaoyan为二级域名、www是三级域名

关于域名需要注意

1. 标号中的英文不区分大小写
2. 标号中除了连字符（-），不能使用其他标点符号
3. 每个标号不超过63个字符，多标号组成的完整域名最长不超过255个字符
4. **级别最低的域名写在最左边，级别最高的域名写在最右边**

![请添加图片描述](https://img-blog.csdnimg.cn/c21542dbd1e74643930003504f31f18e.jpeg)
## 6.2.2 域名服务器
1. **DNS采用C/S模型**

域名服务器主要分四种类型：**根域名服务器、顶级域名服务器、授权域名服务器、本地域名服务器**

1. 根域名服务器是最高层次的域名服务器，所有根域名服务器知道所有顶级域名服务器的IP地址
2. 顶级域名服务器负责管理所有在该顶级域名服务器注册的所有二级域名
3. 授权域名服务器（权限域名服务器）：每台主机必须在授权域名服务器登记。授权域名服务器可以将管辖的主机名转换为该主机的IP地址
4. 本地域名服务器：当一台主机发出DNS查询请求时，请求报文发给该主机的本地域名服务器

![请添加图片描述](https://img-blog.csdnimg.cn/28db63f608e04a7cb4e3a1edb5c13221.jpeg)


## 6.2.3 域名解析过程
**域名解析：将域名映射为IP地址（正向解析）或将IP地址映射为域名（反向解析）**。客户端需要域名解析时，通过本机DNS客户端构造一个DNS请求报文，以**UDP数据报**方式发往本地域名服务器

域名解析有两种方式，**递归查询和递归与迭代相结合的查询**

![请添加图片描述](https://img-blog.csdnimg.cn/8096949c066f41a4be17576c10dadb33.jpeg)
> 1. 假设所有域名服务器采用迭代查询方式进行域名解析，主机访问www.abc.xyz.com的网站时，本地域名服务器完成该域名解析的过程中，可能发出的DNS查询最少次数和最多次数分别是：0和4

# 6.3 文件传输协议（FileTransferProtocol
## 6.3.1 FTP工作原理
文件传输协议FTP，提供交互式访问，允许客户指明文件的类型和格式，允许文件具有存取权限。屏蔽了各计算机系统的细节，适合在异构网络中的任意计算机之间传送文件

1. 提供不同种类主机系统之间的文件传输能力（硬件、软件体系等都可以不同
2. 以用户权限管理的方式提供公用文件共享的能力
3. 以匿名FTP的方式提供公用文件共享的能力
4. 采用**C/S模式**
5. 使用**TCP可靠传输服务**
6. 一个FTP服务器进程可以同时为多个多个客户进程提供服务

FTP服务器进程包括：一个主进程，负责接收新的请求；另外有若干从属进程，负责处理单个请求

工作流程：
1. 打开熟知端口号21（FTP控制端口），使客户进程连接上
2. 等待客户进程发连接请求
3. 启动从属进程进程处理客户进程发来的请求。主进程和从属进程并发执行，从属进程对客户进程的请求处理完毕后即终止
4. 回到等待状态，继续接收其他客户进程的请求

## 6.3.2 控制连接与数据连接
FTP在工作时使用两个并行的TCP连接：控制连接（端口号21）、数据连接（端口号20）。**注意端口号是服务器方的端口**

![在这里插入图片描述](https://img-blog.csdnimg.cn/50414e98c4c64f6189441d1e21fca117.jpeg)
### 1. 控制连接
1. 服务器监听21号端口，等待客户连接，建立在这个端口上的连接称为控制连接
2. 控制连接用于传输控制信息（例如连接请求、传送请求等）
3. 控制信息以7位ASCII格式传送
4. **控制连接在整个会话期间一直保持打开状态**

> 1. FTP的控制信息是带外传送
> 2. FTP客户和服务器之间传递FTP命令时，使用的连接是建立在TCP上的控制连接

### 2. 数据连接
> 1. 一台计算机从FTP服务器下载文件时，在该服务器上对数据进行封装的五个转换步骤是：数据（应用层）、数据段（传输层）、数据报（网络层）、数据帧（数据链路层）、比特（物理层）

# 6.4 电子邮件
![请添加图片描述](https://img-blog.csdnimg.cn/bbad4c5af0f54d7098e1339f844d7768.png)

1. 发送方用户代理 -> 发送方邮件服务器：SMTP协议（TCP
2. 发送方邮件服务器 -> 接收方邮件服务器：SMTP协议（TCP
3. 接收方邮件服务器 -> 接收方用户代理：POP3协议（TCP

电子邮件地址的规定格式：收件人邮箱名@邮箱所在主机的域名

![请添加图片描述](https://img-blog.csdnimg.cn/d0c8d5ccad914aa88bebe094d948ada2.png)

![请添加图片描述](https://img-blog.csdnimg.cn/ee68a63d887c4d12bd02fdcd8bda1741.png)
1. **SMTP只支持传输7比特ASCII码内容**
2. 支持在邮件服务器之间发送邮件
3. 支持从用户代理向邮件服务器发送邮件
4. **不支持从邮件服务器向用户代理发送邮件**

![请添加图片描述](https://img-blog.csdnimg.cn/1e754c9bf69d425e89c2348956b5be87.png)![请添加图片描述](https://img-blog.csdnimg.cn/edd4e70aa2c34fb1a26c36abcaf9354f.png)
> 1. POP3协议，登录到服务器后，密码在传输层明文传送，而非加密

![请添加图片描述](https://img-blog.csdnimg.cn/1dde2a28fbf847e0af68ad5f9f7164b4.png)


![请添加图片描述](https://img-blog.csdnimg.cn/55391474dbdf4371a04bef64ab7a27c8.png)

**基于万维网的邮件，使用HTTP协议，例如Hotmail、Gmail**

# 6.5 万维网（WWW

![请添加图片描述](https://img-blog.csdnimg.cn/7eff23d313c7448a8f4b2222e8abd58c.png)
![请添加图片描述](https://img-blog.csdnimg.cn/15653a99e85e431696d88bda17dc32c4.png)
![请添加图片描述](https://img-blog.csdnimg.cn/ee205f29b34c45c5ad75dc06ce953186.png)
![请添加图片描述](https://img-blog.csdnimg.cn/2bddc104c7dd4981bda6b8199311cfca.png)
> 1. HTTP协议默认为持久链接：1RTT建立TCP、1RTT传输一个MSS

## 6.5.2 超文本传输协议（HTTP
HTTP规定了在浏览器和服务器之间的请求和响应的格式、规则，是万维网上能够可靠地交换文本的重要基础

### 1. HTTP操作过程
1. 服务器进程监听TCP端口80（默认）
2. 监听到请求后建立TCP连接
3. 浏览器向服务器请求获取某个Web页面的HTTP请求
4. 服务器瘦到请求后，构建所请求的Web页面的必须信息，通过HTTP响应返回给浏览器。浏览器将信息进行解释，把Web页面显示给用户
5. 释放TCP
